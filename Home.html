<!DOCTYPE html>
<html style="font-size: 16px;">
   <head>
      <title>Brazillian Business Communities</title>
      <link rel="stylesheet" href="nicepage.css" media="screen">
      <link rel="stylesheet" href="Home.css" media="screen">
      <script class="u-script" type="text/javascript" src="jquery.js" defer=""></script>
      <script class="u-script" type="text/javascript" src="nicepage.js" defer=""></script>
      <link id="u-theme-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i|Open+Sans:300,300i,400,400i,600,600i,700,700i,800,800i">
      <link id="u-page-google-font" rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i">
      <script type="application/ld+json">{
         "@context": "http://schema.org",
         "@type": "Organization",
         "name": "brazillianbusinesscommunities",
         "logo": "images/bbc_logo.png"
           }
      </script>
      <meta name="theme-color" content="#478ac9">
      <meta property="og:title" content="Home">
      <meta property="og:type" content="website">
   </head>
   <body class="u-body">
      <header class="u-clearfix u-custom-color-1 u-header u-header" id="sec-ca42">
         <div class="u-clearfix u-sheet u-sheet-1">
            <a href="/" class="u-image u-logo u-image-1" data-image-width="1239" data-image-height="885">
            <img src="images/bbc_logo.png" class="u-logo-image u-logo-image-1">
            </a>
            <h1 class="u-custom-font u-font-georgia u-text u-title u-text-1">Brazillian Business Communites</h1>
            <nav class="u-menu u-menu-dropdown u-offcanvas u-menu-1">
               <div class="menu-collapse u-custom-font u-font-roboto" style="font-size: 1.25rem; letter-spacing: 0px; text-transform: uppercase; font-weight: 700;">
                  <a class="u-button-style u-custom-active-border-color u-custom-active-color u-custom-border u-custom-border-color u-custom-border-radius u-custom-borders u-custom-color u-custom-hover-border-color u-custom-hover-color u-custom-left-right-menu-spacing u-custom-padding-bottom u-custom-text-active-color u-custom-text-color u-custom-text-hover-color u-custom-top-bottom-menu-spacing u-nav-link u-text-active-palette-1-base u-text-hover-palette-2-base" href="#">
                     <svg>
                        <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#menu-hamburger"></use>
                     </svg>
                     <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
                        <defs>
                           <symbol id="menu-hamburger" viewBox="0 0 16 16" style="width: 16px; height: 16px;">
                              <rect y="1" width="16" height="2"></rect>
                              <rect y="7" width="16" height="2"></rect>
                              <rect y="13" width="16" height="2"></rect>
                           </symbol>
                        </defs>
                     </svg>
                  </a>
               </div>
               <div class="u-custom-menu u-nav-container">
                  <ul class="u-custom-font u-font-roboto u-nav u-spacing-30 u-unstyled u-nav-1">
                     <li class="u-nav-item">
                        <a class="u-border-2 u-button-style u-nav-link u-text-active-white u-text-hover-grey-15 u-text-white" href="/" style="padding: 10px 20px;">Home</a>
                     </li>
                     <li class="u-nav-item">
                        <a class="u-border-2 u-button-style u-nav-link u-text-active-white u-text-hover-grey-15 u-text-white" href="about" style="padding: 10px 20px;">About</a>
                     </li>
                     <li class="u-nav-item">
                        <a class="u-border-2 u-button-style u-nav-link u-text-active-white u-text-hover-grey-15 u-text-white" href="Index.html" style="padding: 10px 13px 10px 20px;">Index</a>
                     </li>
                  </ul>
               </div>
               <div class="u-custom-menu u-nav-container-collapse">
                  <div class="u-black u-container-style u-inner-container-layout u-opacity u-opacity-95 u-sidenav">
                     <div class="u-inner-container-layout u-sidenav-overflow">
                        <div class="u-menu-close"></div>
                        <ul class="u-align-center u-nav u-popupmenu-items u-unstyled u-nav-2">
                           <li class="u-nav-item">
                              <a class="u-button-style u-nav-link" href="/" style="padding: 10px 44px;">Home</a>
                           </li>
                           <li class="u-nav-item">
                              <a class="u-button-style u-nav-link" href="about" style="padding: 10px 44px;">About</a>
                           </li>
                           <li class="u-nav-item">
                             <!-- TODO: Fix -->
                              <a class="u-button-style u-nav-link" href="Index.html" style="padding: 10px 44px;">Index</a>
                           </li>
                        </ul>
                     </div>
                  </div>
                  <div class="u-black u-menu-overlay u-opacity u-opacity-70"></div>
               </div>
            </nav>
         </div>
      </header>

      <section class="u-clearfix u-section-1" id="sec-e61a">
         <div class="u-clearfix u-sheet u-sheet-1">
           <!-- Form... This will create a 'form' object that we can use for the results page query!-->
           <!-- TODO: Header is not showing! -->
            <h2 class="u-text u-text-default u-text-1">Find Business</h2>
            <form id="frm1">
              <div class="wrapper">
                 <input type="text" class="input" id="searchInput" placeholder="Search...">
                 <div class="searchbtn"><i class="fas fa-search"></i></div>
                 <div class="dropdown">
                    <button type="button" onclick="myFunction()" class="dropbtn">Filters</button>
                    <div id="myDropdown" class="dropdown-content">
                       <ul class="category_filters">
                          <li >
                             <input type="checkbox" name="checkboxes" id="provinceInput" value="Province" >
                             <label class="category-label" for="Province" >Province</label>
                             <!-- TODO: Make good -->
                             <div id="provinceList" class="dropdown-content"></div>
                          </li>
                          <li >
                             <input type="checkbox" name="checkboxes" id="employeeInput" value="Number of Employees" >
                             <label class="category-label" for="Number of Employees" >Number of Employees</label>
                          </li>
                       </ul>
                    </div>
                 </div>
                 <button type="button" onclick="search()">Search!</button>
              </div>
            </form>
         </div>
      </section>
      <section class="u-align-center u-clearfix u-grey-5 u-section-2" id="sec-7b69">
         <div class="u-clearfix u-sheet u-valign-middle u-sheet-1">
            <h1 class="u-text u-text-default u-text-1">About Us</h1>
            <p class="u-text u-text-2"> Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce tincidunt
               maximus imperdiet. In id enim ut arcu semper faucibus nec at nisi.
               Donec et magna ut massa consectetur convallis eu ac neque. Suspendisse
               finibus dui sed nisi convallis, nec&nbsp;
            </p>
            <a href="about" data-page-id="11101328" class="u-border-none u-btn u-btn-rectangle u-button-style u-color-scheme-summer-time u-color-style-multicolor-1 u-custom-color-1 u-radius-0 u-btn-1">Learn more</a>
         </div>
      </section>
      <footer class="u-align-center u-clearfix u-footer u-grey-80 u-footer" id="sec-5e92">
         <div class="u-clearfix u-sheet u-sheet-1">
            <p class="u-small-text u-text u-text-variant u-text-1">Lorem ipsum dolor sit amet, consectetur adipiscing elit. Fusce tincidunt maximus imperdiet. In id enim ut</p>
         </div>
      </footer>
      <script type="text/javascript">
         //dropdown function used in form
         function myFunction() {
           document.getElementById("myDropdown").classList.toggle("show");
         }
      </script>



      <script type="text/javascript">
         function search() {
           var form = document.getElementById("frm1");
           console.log(form);

           var searchInput = document.getElementById("searchInput").value;
           searchInput = searchInput.toLowerCase();
           console.log(searchInput);

           //Temporarily assigning these to values
           const checkboxes = ["Sao", "Temp", "Minas Gerais"];
           let checkboxesLength = checkboxes.length;
           var employeeInputLower = "1500";
           employeeInputLower = parseInt(employeeInputLower);
           var employeeInputHigher = "5000";
           employeeInputHigher = parseInt(employeeInputHigher);

           if(window.XMLHttpRequest){
               data_xml=new XMLHttpRequest();
           }
           else {
               data_xml=new ActiveObject("Microsoft.XMLHTTP");
           }

           data_xml.open("GET",'business-data',false);
           data_xml.send();
           xml_str=data_xml.responseXML;

           const businessArray = xml_str.getElementsByTagName("business");
           let companyCount = businessArray.length;

           //Gives reference of overall xml_str structure
           console.log(xml_str);

           var name = "";
           var province = "";
           var employeeCount = "";
           var str = "<html><head><style>table {  font-family: arial, sans-serif;  border-collapse: collapse;  width: 100%;}td, th {  border: 1px solid #dddddd;  text-align: left;  padding: 8px;}tr:nth-child(even) {  background-color: #dddddd;}</style></head><body><h2>Results!</h2>  <table><tr> <th>Company</th>    <th>Province</th>    <th>Number of Employees</th>  </tr>";

           for (let i = 1; i < 2 * companyCount; i += 2) {
             name = ((((xml_str.childNodes[1]).childNodes[i]).childNodes[5]).innerHTML);
             name = name.toLowerCase();
             province = ((((xml_str.childNodes[1]).childNodes[i]).childNodes[13]).innerHTML);
             employeeCount = ((((xml_str.childNodes[1]).childNodes[i]).childNodes[23]).innerHTML);
             employeeCount = parseInt(employeeCount);

             //TODO: Account for no input from search bar
             if(name.includes(searchInput)){
               //TODO: Account for no input from user for employeeCount
               if(employeeInputLower <= employeeCount && employeeCount <= employeeInputHigher){
                 for(let x = 0; x < checkboxesLength; x++){
                   //TODO: set checboxes array all to lowercase & set province to lowercase
                   if(province.includes(checkboxes[x])){
                     console.log(name);
                     str = str +   "<tr>    <td>" + name + "</td>    <td>" + province + "</td>    <td>" + employeeCount+ "</td>  </tr>";
                   }
                 }
               }
             }
             employeeCount = employeeCount.toString();
           }
           //End of string
           str = str + "</table>  <form action='/'>    <input type='submit' value='Go Back!' /></form> </body></html>";
           //TODO: this deletes the old HTML file... Maybe try a different way?
           document.write(str);
         }
      </script>
   </body>
</html>
